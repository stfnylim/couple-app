<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Us">
    <meta name="theme-color" content="#ff6b9d">
    <title>Us - Date Ideas & Recipes</title>
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="apple-touch-icon" href="icon-192.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="login-screen">
        <div class="login-content">
            <h1 class="login-title">Us</h1>
            <p class="login-subtitle">Date Ideas & Recipes for Two</p>
            <button id="googleSignInBtn" class="google-sign-in-btn">
                <svg width="18" height="18" viewBox="0 0 48 48">
                    <path fill="#EA4335" d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"/>
                    <path fill="#4285F4" d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"/>
                    <path fill="#FBBC05" d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"/>
                    <path fill="#34A853" d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"/>
                </svg>
                Sign in with Google
            </button>
        </div>
    </div>

    <div id="app" style="display:none;">
        <!-- Header -->
        <header class="header">
            <button class="header-btn" id="settingsBtn">
                <img id="userAvatar" class="user-avatar" src="" alt="">
            </button>
            <h1>Us</h1>
            <button class="sync-status" id="syncStatus" title="Sync status">
                <span class="sync-icon">&#9679;</span>
            </button>
        </header>

        <!-- Next Dates Section -->
        <section class="next-dates-section" id="nextDatesSection">
            <div class="section-header">
                <h2>Upcoming Plans</h2>
                <button class="add-btn" id="addPlanBtn">+ Add Date</button>
            </div>
            <div class="plans-container" id="plansContainer">
                <!-- Plans will be rendered here -->
            </div>
        </section>

        <!-- Navigation Tabs -->
        <nav class="tabs">
            <button class="tab active" data-tab="dates">Date Ideas</button>
            <button class="tab" data-tab="recipes">Recipes</button>
        </nav>

        <!-- Date Ideas Section -->
        <section class="content-section active" id="datesSection">
            <div class="filters" id="dateFilters">
                <button class="filter-btn active" data-filter="all">All</button>
                <button class="filter-btn" data-filter="indoor">Indoor</button>
                <button class="filter-btn" data-filter="outdoor">Outdoor</button>
                <button class="filter-btn" data-filter="free">Free</button>
                <button class="filter-btn" data-filter="creative">Creative</button>
                <button class="filter-btn" data-filter="active">Active</button>
                <button class="filter-btn" data-filter="food">Food</button>
                <button class="filter-btn" data-filter="relaxing">Relaxing</button>
            </div>
            <div class="cards-container" id="datesContainer">
                <!-- Date cards will be rendered here -->
            </div>
            <button class="fab" id="addDateBtn">+</button>
        </section>

        <!-- Recipes Section -->
        <section class="content-section" id="recipesSection">
            <div class="cards-container" id="recipesContainer">
                <!-- Recipe cards will be rendered here -->
            </div>
            <button class="fab" id="addRecipeBtn">+</button>
        </section>
    </div>

    <!-- Add Date Modal -->
    <div class="modal" id="dateModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="dateModalTitle">Add Date Idea</h3>
                <button class="close-btn" data-close="dateModal">&times;</button>
            </div>
            <form id="dateForm">
                <input type="hidden" id="dateId">
                <div class="form-group">
                    <label for="dateName">Name</label>
                    <input type="text" id="dateName" required placeholder="e.g., Sunset Picnic">
                </div>
                <div class="form-group">
                    <label for="dateLocation">Location</label>
                    <input type="text" id="dateLocation" placeholder="e.g., Central Park">
                </div>
                <div class="form-group">
                    <label for="dateAddress">Address / Maps Link</label>
                    <input type="text" id="dateAddress" placeholder="Paste Google Maps link or address">
                </div>
                <div class="form-group">
                    <label for="dateNotes">Notes</label>
                    <textarea id="dateNotes" rows="2" placeholder="Any additional details..."></textarea>
                </div>
                <div class="form-group">
                    <label>Tags</label>
                    <div class="tags-selector">
                        <label class="tag-option"><input type="checkbox" value="indoor"> Indoor</label>
                        <label class="tag-option"><input type="checkbox" value="outdoor"> Outdoor</label>
                        <label class="tag-option"><input type="checkbox" value="free"> Free</label>
                        <label class="tag-option"><input type="checkbox" value="creative"> Creative</label>
                        <label class="tag-option"><input type="checkbox" value="active"> Active</label>
                        <label class="tag-option"><input type="checkbox" value="food"> Food</label>
                        <label class="tag-option"><input type="checkbox" value="relaxing"> Relaxing</label>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" data-close="dateModal">Cancel</button>
                    <button type="submit" class="btn-primary">Save</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Recipe Modal -->
    <div class="modal" id="recipeModal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3 id="recipeModalTitle">Add Recipe</h3>
                <button class="close-btn" data-close="recipeModal">&times;</button>
            </div>
            <form id="recipeForm">
                <input type="hidden" id="recipeId">
                <div class="form-group">
                    <label for="recipeName">Recipe Name</label>
                    <input type="text" id="recipeName" required placeholder="e.g., Homemade Pasta">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="recipeTime">Cook Time</label>
                        <input type="text" id="recipeTime" placeholder="e.g., 45 mins">
                    </div>
                    <div class="form-group">
                        <label for="recipeServings">Servings</label>
                        <input type="text" id="recipeServings" placeholder="e.g., 2">
                    </div>
                </div>
                <div class="form-group">
                    <label for="recipeIngredients">Ingredients (one per line)</label>
                    <textarea id="recipeIngredients" rows="5" placeholder="2 cups flour&#10;3 eggs&#10;1 tsp salt"></textarea>
                </div>
                <div class="form-group">
                    <label for="recipeInstructions">Instructions</label>
                    <textarea id="recipeInstructions" rows="5" placeholder="Step by step instructions..."></textarea>
                </div>
                <div class="form-group">
                    <label for="recipeLink">Recipe Link (optional)</label>
                    <input type="url" id="recipeLink" placeholder="https://...">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" data-close="recipeModal">Cancel</button>
                    <button type="submit" class="btn-primary">Save</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Plan Modal -->
    <div class="modal" id="planModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Plan a Date</h3>
                <button class="close-btn" data-close="planModal">&times;</button>
            </div>
            <form id="planForm">
                <input type="hidden" id="planId">
                <div class="form-group">
                    <label for="planDate">Date (optional)</label>
                    <input type="date" id="planDate">
                </div>
                <div class="form-group">
                    <label for="planTime">Time (optional)</label>
                    <input type="time" id="planTime">
                </div>
                <div class="form-group">
                    <label for="planTitle">Title (optional)</label>
                    <input type="text" id="planTitle" placeholder="e.g., Anniversary dinner">
                </div>
                <div class="form-group">
                    <label>Date Ideas (optional)</label>
                    <div class="date-selector" id="dateSelectorList">
                        <!-- Date options will be rendered here -->
                    </div>
                </div>
                <div class="form-group">
                    <label>Recipes (optional)</label>
                    <div class="date-selector" id="recipeSelectorList">
                        <!-- Recipe options will be rendered here -->
                    </div>
                </div>
                <div class="form-group">
                    <label for="planNotes">Notes</label>
                    <textarea id="planNotes" rows="2" placeholder="Any notes for this plan..."></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" data-close="planModal">Cancel</button>
                    <button type="submit" class="btn-primary">Add Plan</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div class="modal" id="confirmModal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h3>Confirm Delete</h3>
                <button class="close-btn" data-close="confirmModal">&times;</button>
            </div>
            <p id="confirmMessage">Are you sure you want to delete this?</p>
            <div class="form-actions">
                <button type="button" class="btn-secondary" data-close="confirmModal">Cancel</button>
                <button type="button" class="btn-danger" id="confirmDeleteBtn">Delete</button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Settings</h3>
                <button class="close-btn" data-close="settingsModal">&times;</button>
            </div>
            <div class="settings-section">
                <div class="user-info">
                    <img id="settingsAvatar" class="settings-avatar" src="" alt="">
                    <div>
                        <div id="settingsName" class="settings-name"></div>
                        <div id="settingsEmail" class="settings-email"></div>
                    </div>
                </div>
            </div>
            <div class="settings-section">
                <h4>Your Space</h4>
                <p id="spaceStatus">Not connected to a space.</p>
                <div id="inviteCodeSection" style="display:none;">
                    <label class="settings-label">Invite Code (share with your partner):</label>
                    <div class="invite-code-display">
                        <code id="inviteCodeDisplay"></code>
                        <button id="copyInviteBtn" class="btn-small">Copy</button>
                    </div>
                </div>
                <div id="joinSpaceSection" style="display:none;">
                    <label class="settings-label">Join your partner's space:</label>
                    <div class="join-space-form">
                        <input type="text" id="joinCodeInput" placeholder="Enter invite code" maxlength="6">
                        <button id="joinSpaceBtn" class="btn-primary btn-small">Join</button>
                    </div>
                    <p class="settings-hint">Or create a new space:</p>
                    <button id="createSpaceBtn" class="btn-secondary btn-small" style="width:100%;">Create Space</button>
                </div>
            </div>
            <div class="settings-section">
                <button id="signOutBtn" class="btn-danger" style="width:100%;">Sign Out</button>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <!-- App Script -->
    <script src="app.js"></script>
</body>
</html>
